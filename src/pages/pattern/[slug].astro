---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { render } from "astro:content";

const { slug } = Astro.params;

export async function getStaticPaths() {
  const posts = await getCollection("patterns", ({ data }) => {
    return data.draft !== true;
  });
  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<BaseLayout>
  <a
    href="/"
    class="inline-flex items-center gap-2 text-sm font-medium text-sky-700 hover:text-sky-800 dark:text-sky-300 dark:hover:text-sky-200 transition-colors"
  >
    <span aria-hidden="true">‚Üê</span>
    Back to patterns
  </a>

  <header
    class="space-y-4 border-b border-slate-200 pb-8 pt-4 dark:border-slate-800"
  >
    <div class="flex flex-wrap items-center text-sm text-slate-500 pb-5">
      <span
        class="inline-flex items-center rounded-full border border-slate-200 px-3 py-1 dark:border-slate-700 dark:text-slate-300"
      >
        Pattern #{post.data.id.toString().padStart(3, "0")}
      </span>
    </div>

    <p
      class="text-sm font-semibold uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400"
    >
      {post.data.type} Pattern
    </p>

    <h1
      class="text-5xl font-bold tracking-tight text-slate-900 dark:text-slate-100 pb-5"
    >
      {post.data.title}
    </h1>

    <p class="text-sm text-slate-500 dark:text-slate-400">
      Added: {
        new Date(post.data.added).toLocaleDateString("en-GB", {
          year: "numeric",
          month: "long",
          day: "numeric",
        })
      }
    </p>
  </header>

  <article
    class="prose prose-slate max-w-none pt-8 dark:prose-invert prose-h1:hidden prose-headings:font-semibold prose-headings:text-slate-900 dark:prose-headings:text-slate-100 prose-a:text-sky-700 hover:prose-a:text-sky-800 dark:prose-a:text-sky-300 dark:hover:prose-a:text-sky-200"
  >
    <Content />
  </article>
</BaseLayout>
