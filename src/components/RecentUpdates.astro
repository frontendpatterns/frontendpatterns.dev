---
import { getCollection } from "astro:content";

const patterns = (
  await getCollection("patterns", ({ data }) => {
    return data.draft !== true;
  })
)
  .sort((a, b) => new Date(b.data.added) - new Date(a.data.added))
  .slice(0, 5);
---

<div
  class="overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm dark:border-slate-800 dark:bg-slate-900"
>
  <table class="w-full border-collapse text-left">
    <thead
      class="bg-slate-100/80 text-sm uppercase tracking-wide text-slate-600 dark:bg-slate-800 dark:text-slate-300"
    >
      <tr>
        <th class="px-3 py-2 md:px-6 md:py-3 font-semibold">Pattern</th>
        <th class="px-3 py-2 md:px-6 md:py-3 font-semibold">Category</th>
        <th class="px-3 py-2 md:px-6 md:py-3 font-semibold text-right"
          >Updated</th
        >
      </tr>
    </thead>
    <tbody
      class="divide-y divide-slate-200 text-xs md:text-sm dark:divide-slate-800"
    >
      {
        patterns.map((pattern) => (
          <tr class="transition-colors hover:bg-slate-50 dark:hover:bg-slate-800/60">
            <td class="px-3 py-2 md:px-6 md:py-4 font-medium text-slate-900 dark:text-slate-100">
              <a
                href={`/p/${pattern.id}`}
                class="text-slate-900 underline decoration-slate-200 decoration-2 underline-offset-4 transition-colors hover:text-sky-700 hover:decoration-sky-500 dark:text-slate-100 dark:decoration-slate-700 dark:hover:text-sky-300 dark:hover:decoration-sky-400"
              >
                #{pattern.data.id.toString().padStart(3, "0")}:{" "}
                {pattern.data.title}
                {new Date() - new Date(pattern.data.added) <
                30 * 24 * 60 * 60 * 1000 ? (
                  <span class="ml-2 inline-block rounded-full bg-sky-100 px-2 py-0.5 text-xs font-semibold text-sky-800 dark:bg-sky-800/20 dark:text-sky-200">
                    NEW
                  </span>
                ) : null}
              </a>
            </td>
            <td class="px-3 py-2 md:px-6 md:py-4 text-slate-600 dark:text-slate-300">
              {pattern.data.category}
            </td>
            <td class="px-3 py-2 md:px-6 md:py-4 text-right text-slate-500 dark:text-slate-400">
              {new Date(pattern.data.added).toLocaleDateString("en-GB", {
                year: "numeric",
                month: "short",
                day: "numeric",
              })}
            </td>
          </tr>
        ))
      }
    </tbody>
  </table>
</div>
